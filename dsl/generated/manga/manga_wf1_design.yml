app:
  description: "WF1: Learning Design - æ•™è‚²è¨­è¨ˆã®éª¨çµ„ã¿ä½œæˆ"
  icon: "ğŸ“š"
  icon_background: '#E4FBCC'
  mode: workflow
  name: "Manga WF1 - Learning Design"
  use_icon_as_answer_icon: false
kind: app
version: 0.1.2

workflow:
  conversation_variables: []
  environment_variables: []
  features:
    file_upload:
      image:
        enabled: false
        number_limits: 3
        transfer_methods:
        - local_file
        - remote_url
    opening_statement: ''
    retriever_resource:
      enabled: true
    sensitive_word_avoidance:
      enabled: false
    speech_to_text:
      enabled: false
    suggested_questions: []
    suggested_questions_after_answer:
      enabled: false
    text_to_speech:
      enabled: false
      language: ''
      voice: ''

  graph:
    edges:
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: start
        targetType: knowledge-retrieval
      id: edge-start-to-rag
      source: '1000000001'
      sourceHandle: source
      target: '1000000002'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: knowledge-retrieval
        targetType: llm
      id: edge-rag-to-llm
      source: '1000000002'
      sourceHandle: source
      target: '1000000003'
      targetHandle: target
      type: custom
      zIndex: 0
    - data:
        isInIteration: false
        isInLoop: false
        sourceType: llm
        targetType: end
      id: edge-llm-to-end
      source: '1000000003'
      sourceHandle: source
      target: '1000000004'
      targetHandle: target
      type: custom
      zIndex: 0

    nodes:
    - data:
        desc: 'ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿'
        selected: false
        title: Start
        type: start
        variables:
        - label: theme
          max_length: 500
          options: []
          required: true
          type: paragraph
          variable: theme
        - label: learning_goal
          max_length: 500
          options: []
          required: true
          type: paragraph
          variable: learning_goal
        - default: 4
          label: total_pages
          options: []
          required: true
          type: number
          variable: total_pages
        - label: characters
          max_length: 200
          options: []
          required: true
          type: text-input
          variable: characters
        - label: setting_location
          max_length: 200
          options: []
          required: true
          type: text-input
          variable: setting_location
        - label: setting_time
          max_length: 100
          options: []
          required: true
          type: text-input
          variable: setting_time
        - default: 'modern realistic'
          label: art_style
          max_length: 100
          options: []
          required: false
          type: text-input
          variable: art_style
        - default: 'beginner'
          label: difficulty
          max_length: 50
          options: []
          required: false
          type: text-input
          variable: difficulty
      height: 320
      id: '1000000001'
      position:
        x: 80
        y: 200
      positionAbsolute:
        x: 80
        y: 200
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244

    - data:
        dataset_ids: []
        multiple_retrieval_config:
          reranking_enable: false
          reranking_mode: weighted_score
          top_k: 4
          weights:
            keyword_setting:
              keyword_weight: 0
            vector_setting:
              embedding_model_name: text-embedding-3-large
              embedding_provider_name: langgenius/openai/openai
              vector_weight: 1
            weight_type: customized
        query_variable_selector:
        - '1000000001'
        - theme
        retrieval_mode: multiple
        selected: false
        title: Knowledge Retrieval
        type: knowledge-retrieval
      height: 90
      id: '1000000002'
      position:
        x: 380
        y: 200
      positionAbsolute:
        x: 380
        y: 200
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244

    - data:
        context:
          enabled: true
          variable_selector:
          - '1000000002'
          - result
        desc: 'æ•™è‚²è¨­è¨ˆã®éª¨çµ„ã¿ç”Ÿæˆ'
        edition_type: basic
        model:
          completion_params:
            temperature: 0.7
          mode: chat
          name: gpt-4o
          provider: langgenius/openai/openai
        prompt_template:
        - id: sys-001
          role: system
          text: |
            ã‚ãªãŸã¯å»ºè¨­æ¥­ç•Œå‘ã‘æ•™è‚²ãƒãƒ³ã‚¬ã®æ•™è‚²è¨­è¨ˆã‚¨ã‚­ã‚¹ãƒ‘ãƒ¼ãƒˆã§ã™ã€‚

            æ—¥æœ¬ã®ç‰©èªæ§‹é€ ï¼ˆèµ·æ‰¿è»¢çµï¼‰ã«å¾“ã£ã¦æ•™è‚²æ§‹é€ ã‚’è¨­è¨ˆã—ã¦ãã ã•ã„ï¼š
            - èµ·ï¼ˆå°å…¥ï¼‰: çŠ¶æ³è¨­å®š
            - æ‰¿ï¼ˆå±•é–‹ï¼‰: å­¦ç¿’å†…å®¹ã®å±•é–‹
            - è»¢ï¼ˆè»¢æ›ï¼‰: èª²é¡Œã¾ãŸã¯é‡è¦ãªæ°—ã¥ã
            - çµï¼ˆçµæœ«ï¼‰: è§£æ±ºã¨å­¦ã³

            å‡ºåŠ›ã¯å¿…ãšä»¥ä¸‹ã®JSONå½¢å¼ã§å‡ºåŠ›ã—ã¦ãã ã•ã„ï¼š
            {
              "story_overview": {
                "title": "ãƒãƒ³ã‚¬ã®ã‚¿ã‚¤ãƒˆãƒ«",
                "theme": "ãƒ†ãƒ¼ãƒ",
                "learning_goal": "å­¦ç¿’ç›®æ¨™",
                "target_audience": "å¯¾è±¡è€…",
                "total_pages": 4,
                "story_arc": {
                  "ki": "èµ·ã®èª¬æ˜",
                  "sho": "æ‰¿ã®èª¬æ˜",
                  "ten": "è»¢ã®èª¬æ˜",
                  "ketsu": "çµã®èª¬æ˜"
                }
              },
              "learning_objectives": ["ç›®æ¨™1", "ç›®æ¨™2", "ç›®æ¨™3"],
              "educational_points": [
                {"point_number": 1, "content": "å†…å®¹", "category": "ki"}
              ],
              "pages": [
                {
                  "page_number": 1,
                  "arc_phase": "ki",
                  "learning_focus": "ã“ã®ãƒšãƒ¼ã‚¸ã®å­¦ç¿’ç„¦ç‚¹",
                  "key_message": "ã‚­ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸"
                }
              ]
            }
        - id: user-001
          role: user
          text: |
            ãƒ†ãƒ¼ãƒ: {{#1000000001.theme#}}
            å­¦ç¿’ç›®æ¨™: {{#1000000001.learning_goal#}}
            ãƒšãƒ¼ã‚¸æ•°: {{#1000000001.total_pages#}}
            ç™»å ´äººç‰©: {{#1000000001.characters#}}
            å ´æ‰€è¨­å®š: {{#1000000001.setting_location#}}
            æ™‚é–“è¨­å®š: {{#1000000001.setting_time#}}
            ã‚¢ãƒ¼ãƒˆã‚¹ã‚¿ã‚¤ãƒ«: {{#1000000001.art_style#}}
            é›£æ˜“åº¦: {{#1000000001.difficulty#}}

            å‚è€ƒçŸ¥è­˜:
            {{#context#}}

            ä¸Šè¨˜ã®æƒ…å ±ã‚’ã‚‚ã¨ã«ã€æ•™è‚²ãƒãƒ³ã‚¬ã®è¨­è¨ˆJSONã‚’ç”Ÿæˆã—ã¦ãã ã•ã„ã€‚
            å‡ºåŠ›ã¯JSONã®ã¿ã§ã€ãƒãƒ¼ã‚¯ãƒ€ã‚¦ãƒ³ã®ã‚³ãƒ¼ãƒ‰ãƒ–ãƒ­ãƒƒã‚¯ã¯ä½¿ç”¨ã—ãªã„ã§ãã ã•ã„ã€‚
        selected: false
        structured_output_enabled: false
        title: 'LLM: Learning Design'
        type: llm
        variables: []
        vision:
          enabled: false
      height: 98
      id: '1000000003'
      position:
        x: 680
        y: 200
      positionAbsolute:
        x: 680
        y: 200
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244

    - data:
        desc: ''
        outputs:
        - value_selector:
          - '1000000003'
          - text
          variable: design_json
        - value_selector:
          - '1000000002'
          - result
          variable: rag_context
        selected: false
        title: End
        type: end
      height: 118
      id: '1000000004'
      position:
        x: 980
        y: 200
      positionAbsolute:
        x: 980
        y: 200
      selected: false
      sourcePosition: right
      targetPosition: left
      type: custom
      width: 244

    viewport:
      x: 0
      y: 0
      zoom: 1

  rag_pipeline_variables: []
